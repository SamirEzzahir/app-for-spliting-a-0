<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Group Expenses</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container mt-5">
  <h2>Group Expenses</h2>

  <!-- Group ID input -->
  <div class="mb-3">
    <label for="groupId" class="form-label">Group ID</label>
    <input type="number" class="form-control" id="groupId" placeholder="Enter group ID">
  </div>

  <!-- Download template -->
  <button class="btn btn-primary mb-3" id="downloadTemplateBtn">Download Template</button>

  <!-- Upload Excel -->
  <div class="mb-3">
    <label for="uploadFile" class="form-label">Upload Expenses Excel</label>
    <input type="file" class="form-control" id="uploadFile" accept=".xlsx,.xls">
  </div>
  <button class="btn btn-success mb-3" id="uploadExpensesBtn">Upload Expenses</button>

  <!-- Download current expenses -->
  <button class="btn btn-info mb-3" id="downloadExpensesBtn">Download Current Expenses</button>

  <div id="message" class="mt-3"></div>
</div>




<script>
 
/*
// Download Template
document.getElementById("downloadTemplateBtn").addEventListener("click", async () => {
  const groupId = document.getElementById("groupId").value;
  if (!groupId) return alert("Enter Group ID");

  const res = await fetch(`${API_URL}/groups/${groupId}/expenses/download-template`, {
    method: "GET"
  });
  if (!res.ok) return alert("Failed to download template");

  const blob = await res.blob();
  const url = window.URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = `group_${groupId}_template.xlsx`;
  a.click();
  window.URL.revokeObjectURL(url);
});

// Upload Expenses
document.getElementById("uploadExpensesBtn").addEventListener("click", async () => {
  const groupId = document.getElementById("groupId").value;
  const fileInput = document.getElementById("uploadFile");
  if (!groupId || !fileInput.files.length) return alert("Enter Group ID and select a file");

  const formData = new FormData();
  formData.append("file", fileInput.files[0]);

  const res = await fetch(`${API_URL}/groups/${groupId}/expenses/upload`, {
    method: "POST",
    body: formData
  });

  if (res.ok) {
    document.getElementById("message").innerHTML = `<div class="alert alert-success">Expenses uploaded successfully!</div>`;
  } else {
    document.getElementById("message").innerHTML = `<div class="alert alert-danger">Failed to upload expenses</div>`;
  }
});

// Download Current Expenses
document.getElementById("downloadExpensesBtn").addEventListener("click", async () => {
  const groupId = document.getElementById("groupId").value;
  if (!groupId) return alert("Enter Group ID");

  const res = await fetch(`${API_URL}/groups/${groupId}/expenses/download`, {
    method: "GET",
    headers: {
      "Content-Type": "application/json",
      "Authorization": "Bearer " + token
    },
  });
  if (!res.ok) return alert("Failed to download expenses");

  const blob = await res.blob();
  const url = window.URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = `group_${groupId}_expenses.xlsx`;
  a.click();
  window.URL.revokeObjectURL(url);
});
</script>*/

    <!-- Bootstrap + Custom JS -->
    <script src="js/login.js"></script>
    <script src="js/config.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/balances.js"></script>
    <script src="js/group.js"></script>
    <script src="js/expense.js"></script>
    <script src="js/index.js"></script>
    <script src="js/script.js"></script>

</body>
</html>
